{% extends 'game/base.html' %}

{% block title %}Settings{% endblock %}

{% block scripts %}
  <script>
    function changeLevelValue(val) {
      document.getElementById("id_level").value = val;
      document.getElementById("id_levels").value = val;
    }
  </script>

{% if choosePerson == True %}
  <script>
    $('#whichPerson').foundation('reveal', 'open');
  </script>
{% endif %}
{{block.super}}
{% endblock %}

{% block css %}
{{block.super}}
  <link href="/static/game/css/level_editor.css" rel="stylesheet" type="text/css">
  <link href="/static/game/css/settings.css" rel="stylesheet" type="text/css">
{% endblock %}

{% block content %}
<div id="wrapper">
  <h4> Settings </h4>
  {{message}} <br>
  <div class="menu">
    <ul class="tabs">

      <li>
        <input type="radio" checked name="tabs" id="tab1">
        <label for="tab1"> Avatar </label>
        <div id="tab-content-avatar" class="tab-content">
          <form method="post" action="">
          {% csrf_token %}
            <h5> {{chooseAvatar}} </h5>

            <div class="avatar_container">
            {% for image in avatarPreUploadedForm.avatars.field.choices %}
              <div id="choice">
                <label>
                  {% if forloop.counter == 1 %}
                    <input type="radio" name="pre-uploaded"
                  value="static/game/image/avatars/{{image}}" checked>
                  {% else %}    
                    <input type="radio" name="pre-uploaded" value="static/game/image/avatars/{{image}}" >
                  {% endif %}
                  <img src="/static/game/image/avatars/{{image}}"/>
                </label>
              </div>
            {% endfor %}
            </div>
            <div class="avatar_container">
              <input id="submitAvatar" type="submit" name="pre" value="Change the avatar">
            </div>
          </form><hr>

          <div class="avatar_container">
            <form method="post" action="" name="user-uploaded"  enctype="multipart/form-data">
            {% csrf_token %}
              <h5> Or upload your own </h5>
              {{avatarUploadForm.avatar}}
              <input type="submit" name="user-uploaded" value="Upload the file">
            </form>
          </div>
        </div>
      </li>

      <li>
        <input type="radio" name="tabs" id="tab2">
        <label for="tab2"> Levels Owned </label>
        <div id="tab-content-levels" class="tab-content">
        <h5> {{levelMessage}} </h5>
        <br>
        {% if levels %}
          {% for level in levels %}
            <div class="levelListing">
              <a href="/game/{{level.id}}"> {{level.name}} </a>
              <span style="float:right">
              Share with
              <a href="#" onclick="changeLevelValue({{level.id}});"
                data-reveal-id="firstModal"> a person </a> |
              <a href="#" onclick="changeLevelValue({{level.id}});"
                data-reveal-id="secondModal"> a class </a>
              </span>
            </div>
          {% endfor %}
        {% else %}
          <button onclick="window.location.href='/game/level_editor'"> Create a level! </button>
        {% endif %}
        </div>
      </li>

      <li>
        <input type="radio" name="tabs" id="tab3">
        <label for="tab3"> Shared Levels </label>
        <div id="tab-content-shared" class="tab-content">
        <h5> {{sharedLevelMessage}} </h5>
        <br>
        {% if sharedLevels %}
          {% for level in sharedLevels %}
          <div class="levelListing">
            <a href="/game/{{level.id}}"> {{level.name}} </a>
          </div>
          {% endfor %}
        {% endif %}
        </div>
      </li>

    </ul>
  </div>
</div>

<div id="profile">
	  {% if user.userprofile.avatar %}
	    <img src="/{{user.userprofile.avatar.url}}" /> 
	  {% endif %}
	  <h4>{{user.username}}</h4>
	  <h5>{{user.first_name}}</h5>
	  <h5>{{user.last_name}} </h5>
</div>

<div id="firstModal" class="reveal-modal" data-reveal>
  <form method="post" id="share-level-person" name="share-level-person" action="">
  <h2 class="title"> {{title}} </h2>
  {% csrf_token %}
    {{shareLevelPersonForm.as_p}}
    <input type="submit" name="share-level-person" value="Submit" />
  </form>
  <a class="close-reveal-modal">&#215;</a>
</div>

<div id="secondModal" class="reveal-modal" data-reveal>
  <h2 class="title"> {{title}} </h2>
  <form method="post" name="share-level-class" action="">
  {% csrf_token %}
    {{shareLevelClassForm.as_p}}

    <input type="submit" name="share-level-class" value="Submit" />
  </form>
  <a class="close-reveal-modal">&#215;</a>
</div>

{% if choosePerson == True %}
<div id="whichPerson" class="reveal-modal" data-reveal>
  <h2 class="title"> {{title}} </h2>
  <form method="post" name="level-choose-person" action="">
  {% csrf_token %}
    {{shareLevelChoosePerson.as_p}}
    <input type="submit" name="level-choose-person" value="Submit">
  </form>
<a class="close-reveal-modal">&#215;</a>
</div>
{% endif %}
{% endblock %}